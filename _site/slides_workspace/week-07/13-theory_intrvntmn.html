<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-10-17">

<title>[Theory] Community-Based Interventions &amp; Theories of Change – ES-202 Course Website</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-79da42d4e9332a072a08d0ee5d72051a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">[Theory] Community-Based Interventions &amp; Theories of Change</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/mariahdaniellecaballero/ES-202" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://rstudio.cloud/spaces/237799" title="RStudio Cloud" class="quarto-navigation-tool px-1" aria-label="RStudio Cloud"><i class="bi bi-cloud-fill"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../centering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Centering Activity</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1-NDZl_DhfwxHM4T2AhiVBVR7m3s6qMOtvYcFUz1r_ps/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Find a Typo?</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#class-overview" id="toc-class-overview" class="nav-link active" data-scroll-target="#class-overview">Class Overview</a></li>
  <li><a href="#centering-activity" id="toc-centering-activity" class="nav-link" data-scroll-target="#centering-activity">Centering Activity</a></li>
  <li><a href="#overview-of-class-schedule" id="toc-overview-of-class-schedule" class="nav-link" data-scroll-target="#overview-of-class-schedule">Overview of Class Schedule</a></li>
  <li><a href="#mid-point-reflection" id="toc-mid-point-reflection" class="nav-link" data-scroll-target="#mid-point-reflection">Mid-point Reflection</a></li>
  <li><a href="#mid-semester-evaluation" id="toc-mid-semester-evaluation" class="nav-link" data-scroll-target="#mid-semester-evaluation">Mid-Semester Evaluation</a>
  <ul class="collapse">
  <li><a href="#looking-ahead" id="toc-looking-ahead" class="nav-link" data-scroll-target="#looking-ahead">Looking Ahead</a></li>
  <li><a href="#website-resources-for-final-project" id="toc-website-resources-for-final-project" class="nav-link" data-scroll-target="#website-resources-for-final-project">Website Resources for Final Project</a></li>
  <li><a href="#project-proposals" id="toc-project-proposals" class="nav-link" data-scroll-target="#project-proposals">Project Proposals</a></li>
  <li><a href="#final-project-team-selections" id="toc-final-project-team-selections" class="nav-link" data-scroll-target="#final-project-team-selections">Final Project Team Selections</a></li>
  <li><a href="#what-we-read" id="toc-what-we-read" class="nav-link" data-scroll-target="#what-we-read">What We Read</a></li>
  <li><a href="#why-a-logic-model" id="toc-why-a-logic-model" class="nav-link" data-scroll-target="#why-a-logic-model">Why a Logic Model?</a></li>
  <li><a href="#basic-logic-model" id="toc-basic-logic-model" class="nav-link" data-scroll-target="#basic-logic-model">Basic Logic Model</a></li>
  <li><a href="#logic-model-discussion" id="toc-logic-model-discussion" class="nav-link" data-scroll-target="#logic-model-discussion">Logic Model Discussion</a></li>
  <li><a href="#childhood-asthma-in-california" id="toc-childhood-asthma-in-california" class="nav-link" data-scroll-target="#childhood-asthma-in-california">Childhood Asthma in California</a></li>
  <li><a href="#cafa-logic-model" id="toc-cafa-logic-model" class="nav-link" data-scroll-target="#cafa-logic-model">CAFA Logic Model</a></li>
  <li><a href="#cafa-strategies-and-outcomes" id="toc-cafa-strategies-and-outcomes" class="nav-link" data-scroll-target="#cafa-strategies-and-outcomes">CAFA Strategies and Outcomes</a></li>
  <li><a href="#logistics" id="toc-logistics" class="nav-link" data-scroll-target="#logistics">Logistics</a></li>
  <li><a href="#tuesday-class" id="toc-tuesday-class" class="nav-link" data-scroll-target="#tuesday-class">Tuesday Class</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="13-theory_intrvntmn.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">[Theory] Community-Based Interventions &amp; Theories of Change</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 17, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="class-overview" class="level2">
<h2 class="anchored" data-anchor-id="class-overview">Class Overview</h2>
<ul>
<li>Centering activity</li>
<li>Mid-semester Logistics</li>
<li>Final Project Team Selections</li>
<li>Intro to Logic Models</li>
<li>Group Discussion + Debrief</li>
</ul>
</section>
<section id="centering-activity" class="level2">
<h2 class="anchored" data-anchor-id="centering-activity">Centering Activity</h2>
<p><img src="images/Witch_name.jpg" class="img-fluid"></p>
</section>
<section id="overview-of-class-schedule" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="overview-of-class-schedule">Overview of Class Schedule</h2>
<p><img src="images/Course_Overview.png" class="img-fluid"></p>
</section>
<section id="mid-point-reflection" class="level2">
<h2 class="anchored" data-anchor-id="mid-point-reflection">Mid-point Reflection</h2>
<ul>
<li>Up until this point we’ve:
<ul>
<li>Reflexively considered our identity through positionality statements</li>
<li>Learned five tenets of justice, and considered them in theory and in praxis using different communities as case studies</li>
<li>Learned introductory skills in data science and visualization</li>
<li>Applied EJ methods and theory to topics of waste, food, water, climate, and energy throughout time and space</li>
</ul></li>
</ul>
</section>
<section id="mid-semester-evaluation" class="level1">
<h1>Mid-Semester Evaluation</h1>
<ul>
<li>Will email out to class, want to collect feedback about how the first half went, and where we’re headed.
<ul>
<li>Due Wednesday, October 22, 2025 at 11:59 PM [Class participation credit]</li>
</ul></li>
</ul>
<section id="looking-ahead" class="level2">
<h2 class="anchored" data-anchor-id="looking-ahead">Looking Ahead</h2>
<ul>
<li><strong>Tuesdays:</strong>
<ul>
<li>5 speakers across FEW + Climate nexus</li>
<li>Representing advocacy and community organizing, academia, and local government.</li>
<li>Mix of education/disciplinary backgrounds, some Wellesley alum!</li>
<li>Sign-up list for speaker engagement: Opportunity for class participation</li>
</ul></li>
<li><strong>Fridays:</strong>
<ul>
<li>In-class time to work on final projects</li>
</ul></li>
</ul>
</section>
<section id="website-resources-for-final-project" class="level2">
<h2 class="anchored" data-anchor-id="website-resources-for-final-project">Website Resources for Final Project</h2>
<ul>
<li><a href="https://mariahdaniellecaballero.github.io/ES-202/final_project/data_sources.html">Data sources</a></li>
<li><a href="https://mariahdaniellecaballero.github.io/ES-202/final_project/-desc.html">Project descriptions</a></li>
</ul>
</section>
<section id="project-proposals" class="level2">
<h2 class="anchored" data-anchor-id="project-proposals">Project Proposals</h2>
<p>Email me a concise description, approximately 300 words in length, outlining the project that you and your team intend to undertake. This should include information such as the environmental justice topic, the community case study, and potential theories that may apply to the case study.</p>
<p>Thoughts on current deadlines?</p>
</section>
<section id="final-project-team-selections" class="level2">
<h2 class="anchored" data-anchor-id="final-project-team-selections">Final Project Team Selections</h2>
<ul>
<li>Teams will be based on your preferences and my discretion</li>
<li>To gain a better sense of your preferences, we’ll make mini resumes for future partners:
<ul>
<li>What to highlight? schedules, skills, leadership styles, interests?</li>
</ul></li>
<li>We’ll spend ~15 minutes circulating and exchanging “resumes”</li>
<li>At the end of the time, you’ll share your collaborator preferences
<ul>
<li>I’ll make final decisions and email out the group names this afternoon.</li>
</ul></li>
</ul>
</section>
<section id="what-we-read" class="level2">
<h2 class="anchored" data-anchor-id="what-we-read">What We Read</h2>
<ul>
<li><strong>Friday:</strong> Kellogg, W. K. (2004). <a href="https://drive.google.com/drive/folders/1F_2-X_JVeQLgaMxbjR0bdntatLOK9uxE">Chapters One and Two</a> in Logic Model Development Guide. Kellogg Foundation.</li>
<li><strong>Friday:</strong> Kreger, M., Sargent, K., Arons, A., Standish, M., &amp; Brindis, C. D. (2011). <a href="https://drive.google.com/drive/folders/1F_2-X_JVeQLgaMxbjR0bdntatLOK9uxE">Creating an environmental justice framework for policy change in childhood asthma: a grassroots to treetops approach</a>. American journal of public health, 101(S1), S208-S216.</li>
</ul>
</section>
<section id="why-a-logic-model" class="level2">
<h2 class="anchored" data-anchor-id="why-a-logic-model">Why a Logic Model?</h2>
<ul>
<li>It’s often easy to define what you <em>want to do</em>, but it’s less easy to define <em>how you’ll get there</em>, and how you’ll <em>evaluate success</em>.</li>
<li>Logic models are useful for communicating a plan for the change you want to see, how you’ll measure impact, and the factors at play.</li>
<li>Program evaluation is a really cool and important job for community impact and change!</li>
</ul>
</section>
<section id="basic-logic-model" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="basic-logic-model">Basic Logic Model</h2>
<ul>
<li>Plan backwards, take inspiration from others, and learn along the way! <img src="images/basic_logic_model.png" class="img-fluid" alt="Kellogg, 2004"></li>
</ul>
</section>
<section id="logic-model-discussion" class="level2">
<h2 class="anchored" data-anchor-id="logic-model-discussion">Logic Model Discussion</h2>
<ul>
<li>What is the value of program evaluation in EJ organizing and policy change?</li>
<li>Why is meaasuring impact important? What’s challenging about measuring impact for local interventions?</li>
<li>Can you see the logic model as a useful tool for new organizations?</li>
</ul>
</section>
<section id="childhood-asthma-in-california" class="level2">
<h2 class="anchored" data-anchor-id="childhood-asthma-in-california">Childhood Asthma in California</h2>
<ul>
<li>Local, regional and state-level initiative to integrate EJ into childhood asthma prevention</li>
<li>Coalition building at the forefront of planning</li>
<li>Flexibility in program implementation and evaluation along the way</li>
<li>Really impressive policy outcomes!</li>
</ul>
</section>
<section id="cafa-logic-model" class="level2">
<h2 class="anchored" data-anchor-id="cafa-logic-model">CAFA Logic Model</h2>
<p>-<img src="images/Kreger_2011.png" class="img-fluid" alt="Kreger, 2011"></p>
</section>
<section id="cafa-strategies-and-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="cafa-strategies-and-outcomes">CAFA Strategies and Outcomes</h2>
<ul>
<li>What are the strengths and challenges of CAFA’s approach?</li>
<li>Thoughts on their “Grasstops” to “Treetops” approach?</li>
<li>What role does data play in CAFA’s EJ advocacy and policy approaches?</li>
</ul>
</section>
<section id="logistics" class="level2">
<h2 class="anchored" data-anchor-id="logistics">Logistics</h2>
<ul>
<li>Class starts at 9:55, please do your very best to make it on time!
<ul>
<li>In addition to my time, I really care about our guest speakers, and I want to ensure we can get through our centering activity AND start our Zoom sessions at 10 AM.</li>
</ul></li>
<li>Alden is joining class on Tuesday as an observer.
<ul>
<li>Thoughts on where he should sit?</li>
</ul></li>
</ul>
</section>
<section id="tuesday-class" class="level2">
<h2 class="anchored" data-anchor-id="tuesday-class">Tuesday Class</h2>
<ul>
<li>Two readings on Navajo Nation and Recognition Justice</li>
<li>Gwen leading centering activity on Tuesday. :-)</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>